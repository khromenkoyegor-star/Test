<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Очистка систем вентиляції | Scrollytelling</title>
    
    <!-- Tailwind CSS (CDN for prototyping) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Playfair+Display:ital,wght@0,600;1,400&display=swap" rel="stylesheet">

    <!-- Tailwind Config for Custom Colors -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        danger: '#ef4444',
                        gold: '#fbbf24',
                        dark: '#000000',
                        glass: 'rgba(255, 255, 255, 0.05)',
                        'glass-border': 'rgba(255, 255, 255, 0.1)',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        serif: ['Playfair Display', 'serif'],
                    },
                    boxShadow: {
                        'glow': '0 0 20px rgba(251, 191, 36, 0.3)',
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #000000;
            color: white;
            /* Штучна висота для скролу. 100vh * кількість тактів */
            height: 1200vh; 
            margin: 0;
            overflow-x: hidden;
        }

        /* Hide scrollbar for cleaner look */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #111;
        }
        ::-webkit-scrollbar-thumb {
            background: #333;
            border-radius: 4px;
        }

        /* Fixed Background Layer */
        .bg-layer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            transition: opacity 0.1s linear;
            z-index: 0;
        }

        #bg-clean {
            /* Fallback color if image missing */
            background-color: #1a202c; 
            background-image: url('clean.webp');
            opacity: 1;
            z-index: 1;
        }

        #bg-dirty {
            /* Fallback color */
            background-color: #000000;
            background-image: url('dirty.webp');
            opacity: 1; /* Changes via JS */
            z-index: 2;
        }

        /* Overlay to darken images slightly for text readability */
        .overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.6);
            z-index: 3;
            pointer-events: none;
        }

        /* Content Stages */
        .stage-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10;
            pointer-events: none; /* Allow scroll through */
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .block-content {
            opacity: 0;
            transform: scale(0.95);
            transition: opacity 0.6s ease, transform 0.6s ease, filter 0.6s ease;
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            pointer-events: none;
            filter: blur(10px);
        }

        .block-content.active {
            opacity: 1;
            transform: scale(1);
            filter: blur(0px);
            pointer-events: auto;
        }

        /* Utilities */
        .glass-panel {
            background: rgba(20, 20, 20, 0.6);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.5);
        }

        /* Block 2: Mind Map Interactions */
        .mind-card {
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            overflow: hidden;
            max-height: 100px; /* Collapsed height */
        }
        .mind-card.expanded {
            max-height: 400px; /* Expanded height */
            background: rgba(40, 40, 40, 0.9);
            border-color: #fbbf24;
        }
        
        /* Block 3: Services */
        .service-img-container {
            position: relative;
            overflow: hidden;
            border-radius: 0.5rem;
        }
        .service-img-clean {
            position: absolute;
            top: 0;
            left: 0;
            opacity: 0;
            transition: opacity 0.4s ease;
        }
        .service-img-container:hover .service-img-clean {
            opacity: 1;
        }
        .service-img-container:hover {
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.5); /* Blue glow */
        }

        /* Marquee */
        .marquee-container {
            overflow: hidden;
            white-space: nowrap;
        }
        .marquee-content {
            display: inline-block;
            animation: marquee 20s linear infinite;
        }
        @keyframes marquee {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }

        /* 3D Perspective for Team */
        .perspective-container {
            perspective: 1000px;
        }
        .team-card-3d {
            transition: transform 0.6s, opacity 0.6s;
            transform-style: preserve-3d;
        }
        
        /* Debug Info */
        #debug {
            position: fixed;
            bottom: 10px;
            right: 10px;
            background: red;
            color: white;
            padding: 5px;
            z-index: 100;
            font-size: 12px;
            display: none; /* Turn on to debug scroll values */
        }
    </style>
</head>
<body>

    <!-- Backgrounds -->
    <div id="bg-clean" class="bg-layer">
        <!-- Fallback image logic handled in CSS/JS if file missing -->
        <!-- <img src="clean.webp" alt="Clean Ventilation" class="w-full h-full object-cover"> -->
    </div>
    <div id="bg-dirty" class="bg-layer">
        <!-- <img src="dirty.webp" alt="Dirty Ventilation" class="w-full h-full object-cover"> -->
    </div>
    
    <!-- Dark Overlay -->
    <div class="overlay"></div>

    <!-- Main Content Container (Fixed Viewport) -->
    <div class="stage-container p-4 md:p-8">

        <!-- BLOCK 1: HERO -->
        <!-- Logic: 100-90 visible -->
        <div id="block-1" class="block-content active">
            <div class="max-w-4xl text-center space-y-6">
                <h1 class="text-6xl md:text-8xl font-black tracking-tighter leading-tight drop-shadow-2xl">
                    <span class="text-danger">64%</span> ЗАГОРЯННЯ <br>НА КУХНЯХ
                </h1>
                <h2 class="text-2xl md:text-4xl font-bold text-gray-300 tracking-wide uppercase">
                    ПОВʼЯЗАНІ З БРУДНОЮ ВЕНТИЛЯЦІЄЮ<span class="text-gold">*</span>
                </h2>
                <div class="mt-20 opacity-70">
                    <div class="w-16 h-16 border-2 border-white rounded-full mx-auto animate-bounce flex items-center justify-center">
                        <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path></svg>
                    </div>
                    <p class="text-sm mt-4 uppercase tracking-widest">Скрольте вниз</p>
                </div>
            </div>
            <div class="absolute bottom-8 text-xs text-gray-500 text-center w-full">
                * За даними провідних міжнародних організацій з пожежної безпеки (NFPA, UK Fire Services, ANSI)
            </div>
        </div>

        <!-- BLOCK 2: MIND MAP (RISKS) -->
        <!-- Logic: 87-75 visible -->
        <div id="block-2" class="block-content">
            <div class="relative w-full max-w-6xl h-full max-h-[800px] flex flex-col md:block">
                
                <!-- Center Title (Desktop) -->
                <div class="hidden md:flex absolute inset-0 items-center justify-center z-20 pointer-events-none">
                    <h2 class="text-4xl font-bold text-center drop-shadow-lg max-w-md">Чим ризикує ваш бізнес?</h2>
                </div>

                <!-- Mobile Title -->
                <h2 class="md:hidden text-3xl font-bold text-center mb-8 text-white">Чим ризикує ваш бізнес?</h2>

                <!-- Grid Layout -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:h-full md:p-12">
                    
                    <!-- Top Left -->
                    <div class="md:absolute md:top-10 md:left-10 md:w-80 z-10">
                        <div class="mind-card glass-panel p-6 rounded-xl group" onclick="toggleCard(this, 'up')">
                            <div class="flex items-center justify-between mb-2">
                                <h3 class="text-xl font-bold text-gold">Пожежа</h3>
                                <svg class="w-6 h-6 text-danger" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z" /></svg>
                            </div>
                            <p class="text-gray-300 text-sm hidden-text opacity-50">Натисніть щоб дізнатись</p>
                            <p class="text-white mt-4 hidden details">Бруд у вентиляції спалахує миттєво і поширює вогонь по всій будівлі за хвилини.</p>
                        </div>
                    </div>

                    <!-- Top Right -->
                    <div class="md:absolute md:top-10 md:right-10 md:w-80 z-10">
                        <div class="mind-card glass-panel p-6 rounded-xl" onclick="toggleCard(this, 'up')">
                            <div class="flex items-center justify-between mb-2">
                                <h3 class="text-xl font-bold text-gold">Штрафи та закриття</h3>
                                <svg class="w-6 h-6 text-gold" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" /></svg>
                            </div>
                            <p class="text-gray-300 text-sm hidden-text opacity-50">Натисніть щоб дізнатись</p>
                            <p class="text-white mt-4 hidden details">Порушення ст. 175 КУПАП та вимог НАССР може призвести до зупинки діяльності.</p>
                        </div>
                    </div>

                    <!-- Bottom Left -->
                    <div class="md:absolute md:bottom-10 md:left-10 md:w-80 z-10">
                        <div class="mind-card glass-panel p-6 rounded-xl" onclick="toggleCard(this, 'down')">
                            <div class="flex items-center justify-between mb-2">
                                <h3 class="text-xl font-bold text-gold">Втрата клієнтів</h3>
                                <svg class="w-6 h-6 text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" /></svg>
                            </div>
                            <p class="text-gray-300 text-sm hidden-text opacity-50">Натисніть щоб дізнатись</p>
                            <p class="text-white mt-4 hidden details">Неефективна витяжка = запахи кухні в залі для клієнтів.</p>
                        </div>
                    </div>

                    <!-- Bottom Right -->
                    <div class="md:absolute md:bottom-10 md:right-10 md:w-80 z-10">
                        <div class="mind-card glass-panel p-6 rounded-xl" onclick="toggleCard(this, 'down')">
                            <div class="flex items-center justify-between mb-2">
                                <h3 class="text-xl font-bold text-gold">Витрата електроенергії</h3>
                                <svg class="w-6 h-6 text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" /></svg>
                            </div>
                            <p class="text-gray-300 text-sm hidden-text opacity-50">Натисніть щоб дізнатись</p>
                            <p class="text-white mt-4 hidden details">Забруднений вентилятор споживає на 30% більше електроенергії.</p>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <!-- BLOCK 3: SERVICES (SOLUTIONS) -->
        <!-- Logic: 70-60 visible -->
        <div id="block-3" class="block-content">
            <div class="w-full max-w-7xl h-full flex flex-col justify-center">
                <div class="glass-panel p-4 mb-6 text-center max-w-4xl mx-auto rounded-lg">
                    <h2 class="text-xl md:text-3xl font-bold text-white">
                        Професійна механічна очистка повітроводів — ефективне вирішення проблеми жирового нагару та бруду
                    </h2>
                </div>

                <!-- Gallery Grid -->
                <div class="grid grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-2 md:gap-4 mb-8 overflow-y-auto max-h-[60vh] md:max-h-none">
                    <!-- Generating 12 Items via Loop Logic in JS, but hardcoding HTML for structure -->
                    <!-- Item 1 -->
                    <div class="aspect-square service-img-container bg-gray-800">
                        <!-- Replace src with 1.webp -->
                        <img src="https://via.placeholder.com/300/330000/FFFFFF?text=Dirty+1" class="w-full h-full object-cover" alt="Before">
                        <img src="https://via.placeholder.com/300/003366/FFFFFF?text=Clean+1" class="w-full h-full object-cover service-img-clean" alt="After">
                    </div>
                    <!-- Item 2 -->
                    <div class="aspect-square service-img-container bg-gray-800">
                        <img src="https://via.placeholder.com/300/330000/FFFFFF?text=Dirty+2" class="w-full h-full object-cover">
                        <img src="https://via.placeholder.com/300/003366/FFFFFF?text=Clean+2" class="w-full h-full object-cover service-img-clean">
                    </div>
                     <!-- Item 3 -->
                     <div class="aspect-square service-img-container bg-gray-800">
                        <img src="https://via.placeholder.com/300/330000/FFFFFF?text=Dirty+3" class="w-full h-full object-cover">
                        <img src="https://via.placeholder.com/300/003366/FFFFFF?text=Clean+3" class="w-full h-full object-cover service-img-clean">
                    </div>
                     <!-- Item 4 -->
                     <div class="aspect-square service-img-container bg-gray-800">
                        <img src="https://via.placeholder.com/300/330000/FFFFFF?text=Dirty+4" class="w-full h-full object-cover">
                        <img src="https://via.placeholder.com/300/003366/FFFFFF?text=Clean+4" class="w-full h-full object-cover service-img-clean">
                    </div>
                     <!-- Item 5 -->
                     <div class="aspect-square service-img-container bg-gray-800">
                        <img src="https://via.placeholder.com/300/330000/FFFFFF?text=Dirty+5" class="w-full h-full object-cover">
                        <img src="https://via.placeholder.com/300/003366/FFFFFF?text=Clean+5" class="w-full h-full object-cover service-img-clean">
                    </div>
                     <!-- Item 6 -->
                     <div class="aspect-square service-img-container bg-gray-800">
                        <img src="https://via.placeholder.com/300/330000/FFFFFF?text=Dirty+6" class="w-full h-full object-cover">
                        <img src="https://via.placeholder.com/300/003366/FFFFFF?text=Clean+6" class="w-full h-full object-cover service-img-clean">
                    </div>
                    <!-- Simplified for prototype, would be 12 items -->
                </div>

                <!-- Footer Block -->
                <div class="glass-panel p-4 rounded-lg">
                    <!-- Mobile -->
                    <div class="md:hidden marquee-container text-gold text-sm font-bold">
                        <div class="marquee-content">
                            Швидкість виконання • Гарантія якості • Сертифіковані засоби • Досвідчена команда • &nbsp;
                            Швидкість виконання • Гарантія якості • Сертифіковані засоби • Досвідчена команда • &nbsp;
                        </div>
                    </div>
                    <!-- Desktop -->
                    <div class="hidden md:flex justify-around items-center text-gray-200">
                        <div class="flex items-center gap-2"><span class="text-gold text-2xl">✓</span> Відеоінспекція</div>
                        <div class="flex items-center gap-2"><span class="text-gold text-2xl">✓</span> Акт виконаних робіт</div>
                        <div class="flex items-center gap-2"><span class="text-gold text-2xl">✓</span> Гарантія чистоти</div>
                        <div class="flex items-center gap-2"><span class="text-gold text-2xl">✓</span> Працюємо 24/7</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- BLOCK 4: PORTFOLIO (CASES) -->
        <!-- Logic: 55-45 visible -->
        <div id="block-4" class="block-content">
            <div class="w-full max-w-6xl">
                <h2 class="text-3xl font-bold mb-8 border-l-4 border-gold pl-4">Кейси (Портфоліо)</h2>
                
                <div class="relative glass-panel rounded-2xl overflow-hidden p-1 md:p-2 min-h-[500px] flex flex-col md:flex-row">
                    <!-- Image Side -->
                    <div class="w-full md:w-1/2 h-64 md:h-auto relative bg-gray-900">
                        <img id="case-img" src="https://via.placeholder.com/800/222222/FFFFFF?text=Case+41" class="absolute inset-0 w-full h-full object-cover transition-all duration-500" alt="Case Study">
                        <div class="absolute top-4 left-4 text-6xl font-black text-white/20" id="case-number">01</div>
                    </div>
                    
                    <!-- Text Side -->
                    <div class="w-full md:w-1/2 p-6 md:p-12 flex flex-col justify-center">
                        <div class="mb-6">
                            <div class="h-1 w-20 bg-gold mb-4"></div>
                            <p id="case-text" class="text-lg md:text-xl text-gray-200 leading-relaxed italic">
                                Loading...
                            </p>
                        </div>
                        
                        <!-- Controls -->
                        <div class="flex gap-4 mt-auto">
                            <button onclick="changeCase(-1)" class="p-3 border border-white/20 rounded-full hover:bg-white/10 hover:border-gold transition-colors">
                                ← Назад
                            </button>
                            <button onclick="changeCase(1)" class="p-3 border border-white/20 rounded-full hover:bg-white/10 hover:border-gold transition-colors">
                                Вперед →
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- BLOCK 5: TEAM -->
        <!-- Logic: 40-30 visible -->
        <div id="block-5" class="block-content">
            <div class="w-full max-w-6xl perspective-container">
                <h2 class="text-center text-4xl font-bold mb-12"><span class="text-gold">Команда</span> Професіоналів</h2>
                
                <!-- 3D Carousel Container -->
                <div class="relative h-[500px] w-full flex items-center justify-center">
                    
                    <button onclick="changeTeam(-1)" class="absolute left-0 z-50 p-4 text-3xl hover:text-gold">❮</button>
                    
                    <!-- Team Card Holder -->
                    <div id="team-stage" class="relative w-full h-full flex justify-center items-center">
                        <!-- Cards injected via JS -->
                    </div>

                    <button onclick="changeTeam(1)" class="absolute right-0 z-50 p-4 text-3xl hover:text-gold">❯</button>
                </div>
            </div>
        </div>

        <!-- BLOCK 6: CONTACTS (Added to fulfill scroll logic) -->
         <!-- Logic: 25-15 visible -->
         <div id="block-6" class="block-content">
            <div class="glass-panel p-10 rounded-2xl text-center max-w-2xl border-t-4 border-danger">
                <h2 class="text-4xl font-bold mb-6">Готові до чистоти?</h2>
                <p class="mb-8 text-xl">Замовте безкоштовну відеоінспекцію вашої системи вже сьогодні.</p>
                <div class="flex flex-col gap-4">
                    <button class="bg-danger text-white py-4 px-8 rounded-full font-bold text-xl hover:bg-red-600 transition shadow-lg shadow-red-900/50">
                        Замовити дзвінок
                    </button>
                    <div class="text-gray-400">або телефонуйте</div>
                    <a href="tel:+380000000000" class="text-3xl font-mono font-bold hover:text-gold transition">+38 (000) 000-00-00</a>
                </div>
            </div>
        </div>

        <!-- BLOCK 7: FINAL (Added to fulfill scroll logic) -->
        <!-- Logic: 10-0 visible -->
        <div id="block-7" class="block-content">
             <div class="text-center">
                 <h1 class="text-6xl md:text-8xl font-black text-white mb-4">LOGOTYPE</h1>
                 <p class="text-gold tracking-[0.5em] uppercase text-sm">Professional Ventilation Cleaning</p>
                 <p class="mt-20 text-gray-600 text-xs">© 2024 Всі права захищено.</p>
             </div>
        </div>

    </div>

    <div id="debug">Scroll: 100%</div>

    <script>
        // --- DATA OBJECTS ---

        const cases = [
            {
                img: "41.webp",
                text: "У деяких системах ми не маємо технічної можливості дістати до проблемних ділянок. В таких випадках ми встановлюємо сервісні лючки які дозволяють швидко та зручно виконати обслуговування зараз та в майбутньому. Оптимально встановлення таких люків у застельовому просторі, де їх не видно але зручно до них дістатися."
            },
            {
                img: "42.webp",
                text: "У ході робіт ми не тільки виконуємо свою роботу а й оглядаємо стан вашої вентсистеми і якщо знаходимо якісь недоліки - виправляємо їх. Як наприклад в цьому випадку, коли старий адаптер дифузора вивалився зі своїх кріплень і лежав на стелі армстронг. Обвал стелі міг відбутися в будь-який момент, а ціна цій трагедії життя та здоровʼя ти хто знаходився б під нею."
            },
            {
                img: "43.webp",
                text: "Особливо цікава історія трапилася при обслуговуванні дренажного коліна до якого приєднано труба для відведення конденсату. За пів року до наших робіт, раптово з усіх щілей магістралі почала витікати чорна жижа. Раптово і незрозуміло чому, зіпсувавши десятки кілограм продукції під магістраллю. Коли ми розібрали коліно, побачили що все воно було забито креозотом, не завдавши збігати рідині. Як результат, вся ця рідина замість стікання в дренаж витікала з усіх можливих щілей."
            },
            {
                img: "44.webp",
                text: "Проводячи роботу і поспілкувавшись з працівниками пекарні ми почули від них скаргу що один із витяжних зонтів гірше засмоктує повітря. Тому ми вирішили провести міні-діагностику системи і знайшли дуже цікаве місце. Там де дві гілки зʼєднуються в магістраль, встановлені зворотні клапани і от один із них заклинив через неправильно вкручений саморіз. Саме це і було причиною слабкої витяжки."
            },
            {
                img: "45.webp",
                text: "Частіше за все, жир протікає через стики зʼєднання повітропроводів між собою. Практика показує, якщо жир потік - відновити його дуже не просто. Для цього треба повністью розʼєднати місце зʼєднання, зачистити його, обезжирити, проспиртувати, нанести новий герметик, АКУРАТНО зʼєднати назад, закрутити. Проблема в тому, що інколи, для того аби розʼєднати одне єдине місце зʼєднання, потрібно розібрати десятки метрів повітропроводу вліво та вправо. Єдине, що можна зробити в таких випадках з уже існуючою проблемою - це акуратно (майже ювелірно) очистити проблемне місце, обезжирити, проспиртувати і нанести герметик з надлишком. Варто відмітити що це не естетично і такі маніпуляції потім видно, але це краще ніж коли старий жир з вентиляції крапає на робоче місце."
            },
            {
                img: "46.webp",
                text: "Інколи буває, що касета армстронга в яку врізано стельовий дифузор - тріскається від деформації. Вирішенням подібної проблеми ми також займаємось."
            }
        ];

        const team = [
            { name: "Хроменко Єгор", role: "Комерційний директор", img: "5.1.webp", quote: "Я починав свій шлях монтажником та проектувальником, щоб знати ціну кожній виконаній роботі. Для мене немає проблеми, яку неможливо вирішити; вирішити можна все, але неможливе вирішується важко і дорого." },
            { name: "Внуков Валерій", role: "Технічний директор", img: "5.2.webp", quote: "Для багатьох висота — це страх; для мене висота — це робота, яка вчить: чим складніший підйом, тим чіткішою стає перспектива" },
            { name: "Ярослав Іванченко", role: "Бригадир", img: "5.3.webp", quote: "Я як хороший метал-альбом: готуюся довго, роблю якісно, і в результаті — качає всіх. Якщо я затримався з монтажем, значить я налаштовую ваш повітровод так само прискіпливо, як свій кардан перед концертом." },
            { name: "Пархоменко Дмитро", role: "Монтажник", img: "5.4.webp", quote: "Я вірю в чесні правила: клієнт отримує ідеально змонтовану систему, а я — справедливу винагороду за свою старанність. Для мене якісна робота — це найнадійніша валюта." },
            { name: "Коваленко Євгеній", role: "Інженер КВП", img: "5.5.webp", quote: "Найкраща автоматика — та, яку ви не помічаєте. Коли все працює — це моя заслуга, якої не видно. Коли щось зупиняється — це стає моєю проблемою, яку я вирішую максимально швидко." }
        ];

        // --- INIT STATE ---
        let currentCaseIndex = 0;
        let currentTeamIndex = 0;

        // --- FUNCTIONS ---

        // SCROLL LOGIC ENGINE
        function handleScroll() {
            const scrollTop = window.scrollY;
            const docHeight = document.body.scrollHeight - window.innerHeight;
            
            // Convert to Percentage (100 at top, 0 at bottom as requested)
            // 0 scroll = 100% val
            const scrollVal = 100 - ((scrollTop / docHeight) * 100);
            
            // Update Dirty Image Opacity (Linear mapping from 100 to 0)
            const dirtyImg = document.getElementById('bg-dirty');
            dirtyImg.style.opacity = scrollVal / 100;

            // Debug
            // document.getElementById('debug').innerText = `Val: ${scrollVal.toFixed(1)}`;

            // Block Logic based on User Ranges
            toggleBlock('block-1', scrollVal, 100, 90, 87);
            toggleBlock('block-2', scrollVal, 87, 75, 73);
            toggleBlock('block-3', scrollVal, 73, 60, 58);
            toggleBlock('block-4', scrollVal, 58, 45, 42);
            toggleBlock('block-5', scrollVal, 42, 30, 27);
            toggleBlock('block-6', scrollVal, 27, 15, 12);
            toggleBlock('block-7', scrollVal, 12, 0, -10); // End
        }

        function toggleBlock(id, val, start, stableEnd, fadeEnd) {
            const el = document.getElementById(id);
            if (!el) return;

            // Logic:
            // > start: Hidden (waiting to appear) - handled by previous block fading
            // start to stableEnd: Visible (Opacity 1) - actually, usually need a fade in buffer
            // stableEnd to fadeEnd: Fade out
            
            // Let's smooth this. 
            // Range: Start -> StableEnd -> FadeEnd
            
            let opacity = 0;
            let scale = 0.95;

            // FADE IN PHASE (e.g. from 90 to 87 for block 2? No, logic says "87-85 appear")
            // Re-reading strict logic:
            // 100-90: Block 1 Full
            // 90-87: Block 1 Fade Out
            // 87-85: Block 2 Fade In
            // 85-75: Block 2 Full
            
            // To simplify, checking active ranges:
            if (val <= start && val > stableEnd) {
                // Main Visible Phase (mostly)
                // Check transition zones
                opacity = 1;
                scale = 1;
            } 
            // Transition OUT (e.g. 90-87 for block 1)
            else if (val <= stableEnd && val > fadeEnd) {
                // Map range to 1 -> 0
                const range = stableEnd - fadeEnd;
                const progress = (val - fadeEnd) / range; // 0 to 1
                opacity = progress;
                scale = 0.95 + (0.05 * progress);
            }
            // Transition IN (previous block faded out, this one appearing)
            // The prompt says "87-85 appears". 
            // We need to look ahead. If we are in "Appear" range.
            // Let's implement a generic approach based on the prompt's specific "Appear" ranges.
            
            // Specific overrides based on prompt Logic:
            
            // BLOCK 1 (100-90 Full, 90-87 Fade Out)
            if (id === 'block-1') {
                if (val > 90) opacity = 1;
                else if (val > 87) opacity = (val - 87) / 3;
                else opacity = 0;
            }
            
            // BLOCK 2 (87-85 Appear, 85-75 Full, 75-73 Fade Out)
            if (id === 'block-2') {
                if (val > 87) opacity = 0;
                else if (val > 85) opacity = 1 - (val - 85) / 2; // Invert logic for appear
                else if (val > 75) opacity = 1;
                else if (val > 73) opacity = (val - 73) / 2;
                else opacity = 0;
            }

            // BLOCK 3 (73-70 Appear, 70-60 Full, 60-58 Fade Out)
            if (id === 'block-3') {
                if (val > 73) opacity = 0;
                else if (val > 70) opacity = 1 - (val - 70) / 3;
                else if (val > 60) opacity = 1;
                else if (val > 58) opacity = (val - 58) / 2;
                else opacity = 0;
            }

            // BLOCK 4 (58-55 Appear, 55-45 Full, 45-42 Fade Out)
            if (id === 'block-4') {
                if (val > 58) opacity = 0;
                else if (val > 55) opacity = 1 - (val - 55) / 3;
                else if (val > 45) opacity = 1;
                else if (val > 42) opacity = (val - 42) / 3;
                else opacity = 0;
            }

             // BLOCK 5 (42-40 Appear, 40-30 Full, 30-27 Fade Out)
             if (id === 'block-5') {
                if (val > 42) opacity = 0;
                else if (val > 40) opacity = 1 - (val - 40) / 2;
                else if (val > 30) opacity = 1;
                else if (val > 27) opacity = (val - 27) / 3;
                else opacity = 0;
            }

            // BLOCK 6 (27-25 Appear, 25-15 Full, 15-12 Fade Out)
            if (id === 'block-6') {
                if (val > 27) opacity = 0;
                else if (val > 25) opacity = 1 - (val - 25) / 2;
                else if (val > 15) opacity = 1;
                else if (val > 12) opacity = (val - 12) / 3;
                else opacity = 0;
            }

            // BLOCK 7 (12-10 Appear, 10-0 Full)
            if (id === 'block-7') {
                if (val > 12) opacity = 0;
                else if (val > 10) opacity = 1 - (val - 10) / 2;
                else opacity = 1;
            }

            // Apply Styles
            if (opacity > 0) {
                el.classList.add('active');
                el.style.opacity = opacity;
                // Subtle scale effect linked to opacity for "breathing" feel
                el.style.transform = `scale(${0.95 + (0.05 * opacity)})`;
            } else {
                el.classList.remove('active');
                el.style.opacity = 0;
            }
        }

        // BLOCK 2 INTERACTION
        function toggleCard(card, direction) {
            // Collapse others
            document.querySelectorAll('.mind-card').forEach(c => {
                if(c !== card) {
                    c.classList.remove('expanded');
                    c.querySelector('.details').classList.add('hidden');
                    c.querySelector('.hidden-text').classList.remove('hidden');
                }
            });

            // Toggle current
            card.classList.toggle('expanded');
            const details = card.querySelector('.details');
            const hint = card.querySelector('.hidden-text');
            
            if(card.classList.contains('expanded')) {
                details.classList.remove('hidden');
                hint.classList.add('hidden');
            } else {
                details.classList.add('hidden');
                hint.classList.remove('hidden');
            }
        }

        // BLOCK 4 LOGIC (Portfolio)
        function updateCaseDisplay() {
            const data = cases[currentCaseIndex];
            // Since we don't have real images, use placeholder with text
            // In production: document.getElementById('case-img').src = data.img;
            document.getElementById('case-img').src = `https://via.placeholder.com/800/222222/FFFFFF?text=Case+${data.img}`; 
            
            document.getElementById('case-number').innerText = `0${currentCaseIndex + 1}`;
            document.getElementById('case-text').innerText = data.text;
        }

        function changeCase(dir) {
            currentCaseIndex += dir;
            if (currentCaseIndex < 0) currentCaseIndex = cases.length - 1;
            if (currentCaseIndex >= cases.length) currentCaseIndex = 0;
            
            // Fade out text briefly
            const textEl = document.getElementById('case-text');
            textEl.style.opacity = 0;
            
            setTimeout(() => {
                updateCaseDisplay();
                textEl.style.opacity = 1;
            }, 200);
        }

        // BLOCK 5 LOGIC (Team)
        function renderTeam() {
            const container = document.getElementById('team-stage');
            container.innerHTML = '';

            team.forEach((member, index) => {
                const diff = index - currentTeamIndex;
                const card = document.createElement('div');
                card.className = 'team-card-3d glass-panel absolute w-64 md:w-80 p-6 rounded-xl flex flex-col items-center text-center transition-all duration-500';
                
                // 3D Transform Logic
                let transform = '';
                let opacity = 0;
                let zIndex = 0;

                if (diff === 0) {
                    // Center
                    transform = 'translateX(0) scale(1) rotateY(0deg)';
                    opacity = 1;
                    zIndex = 10;
                } else if (diff === 1 || (currentTeamIndex === team.length - 1 && index === 0)) {
                    // Right
                    transform = 'translateX(100%) scale(0.8) rotateY(-25deg)';
                    opacity = 0.6;
                    zIndex = 5;
                } else if (diff === -1 || (currentTeamIndex === 0 && index === team.length - 1)) {
                    // Left
                    transform = 'translateX(-100%) scale(0.8) rotateY(25deg)';
                    opacity = 0.6;
                    zIndex = 5;
                } else {
                    // Hidden
                    transform = 'scale(0.5)';
                    opacity = 0;
                    zIndex = 0;
                }
                
                // Adjust for wrapping (infinite carousel visual)
                // Simplified for this prototype: Just hiding non-adjacent

                card.style.transform = transform;
                card.style.opacity = opacity;
                card.style.zIndex = zIndex;

                if (opacity > 0) {
                    card.innerHTML = `
                        <div class="w-24 h-24 rounded-full overflow-hidden mb-4 border-2 border-gold shadow-glow">
                             <img src="https://via.placeholder.com/150/000000/FFFFFF?text=${member.name.split(' ')[0]}" class="w-full h-full object-cover grayscale hover:grayscale-0 transition">
                        </div>
                        <h3 class="text-xl font-bold">${member.name}</h3>
                        <p class="text-gold text-sm mb-4 uppercase tracking-wider">${member.role}</p>
                        <p class="font-serif italic text-sm text-gray-300">"${member.quote}"</p>
                    `;
                    container.appendChild(card);
                }
            });
        }

        function changeTeam(dir) {
            currentTeamIndex += dir;
            if (currentTeamIndex < 0) currentTeamIndex = team.length - 1;
            if (currentTeamIndex >= team.length) currentTeamIndex = 0;
            renderTeam();
        }

        // --- INITIALIZATION ---
        window.addEventListener('scroll', () => requestAnimationFrame(handleScroll));
        window.addEventListener('load', () => {
            handleScroll(); // Init positions
            updateCaseDisplay(); // Init portfolio
            renderTeam(); // Init team
        });

    </script>
</body>
</html>

